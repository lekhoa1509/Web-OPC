@{ ViewBag.Title = "OPC Bao Cao | OPCPHARMA";
    @model System.Data.DataSet
}
@using System.Data;
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <title> OPC Bao Cao | OPCPHARMA </title>
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link href="~/Styles/main.css" rel='stylesheet' type='text/css' media="all">
    @*<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">*@
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="~/Styles/loader.css">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <style>
        body {
            font-family: 'Helvetica Neue', Helvetica, sans-serif;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        .collapsed {
            display: none;
        }

        .contentList {
            display: none;
        }

        .tabs {
            display: inline-block;
            /* bottom: 0;
            left: 0;
            right: 0;*/
            width: 300vh;
            height: 50px;
            /* margin: 15px auto;*/
            border-bottom: 1px solid #DAE0E7;
            background: #F9F9F9;
            list-style-type: none;
            padding: 0px 12px 0;
        }

        a {
            text-decoration: none;
            color: #333;
        }

        .tab {
            float: left;
            height: 44px;
            margin: 0 8px -1px 0;
            border: 1px solid #DAE0E7;
            background: #F9F9F9;
            border-radius: 0px 0px 0 0;
            overflow: hidden;
        }

            .tab, .tab a {
                transition: all .25s;
            }

                .tab a {
                    display: inline-block;
                }

                    .tab a:first-child {
                        padding: 12px 2px 12px 16px;
                        white-space: nowrap;
                    }

                .tab.tabClosed, .tab.tabClosed a:first-child {
                    margin-right: 0;
                    border-width: 0;
                }

                .tab.tabClosed {
                    width: 0 !important; /* use important because we need to set the width of tabs in javascript in order to be able to animate them to 0 */
                }

                    .tab.tabClosed a {
                        opacity: 0;
                    }

        .closeTab:hover {
            background: #DAE0E7;
        }

        .tab-control {
            z-index: 100;
            position: fixed;
        }

            .tab-control ul {
                position: absolute;
                bottom: 0px;
                /* left:300px;*/
            }

                .tab-control ul li {
                    text-align: center;
                }
    </style>
</head>
<body>
    <div class="loader" style="z-index:1"></div>
    <div class="sidebar close">
        <div class="logo-details">
            <img src="~/Images/opc.png" style="height:50px;width:50px;margin-left:10px">
            <span class="logo_name" style="color: #da261f; font-family: 'Agency FB'; font-size: 40px;padding-left:10px">OPC</span>
        </div>
        <ul class="nav-links">
            <li id="active">
                <a href="/Home/About">
                    <i class='bx bx-grid-alt'></i>
                    <span class="link_name">Trang chủ</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name" href="#">Trang chủ</a></li>
                </ul>
            </li>
            <li>
                <div class="iocn-link">
                    <a href="/DanhMuc/DanhMuc">
                        <i class='bx bx-collection'></i>
                        <span class="link_name">Danh mục</span>
                    </a>
                    <ul class="sub-menu blank">
                        <li><a class="link_name" href="/DanhMuc/DanhMuc">Danh mục</a></li>
                    </ul>
                    @*<i class='bx bxs-chevron-down arrow'></i>*@
                </div>

                <ul class="sub-menu">
                    <li><a class="link_name" href="#">Danh mục</a></li>
                    <li class="liTitle">
                        @if (string.Equals(ViewBag.UserName, "admin", StringComparison.OrdinalIgnoreCase) ||
string.Equals(ViewBag.UserName, "opcmar001", StringComparison.OrdinalIgnoreCase))
                        {


                            <a href="/DanhMuc/ViewDanhMucKH_Fill" onclick="runReport()"> Khách hàng</a>
                        }
                        else if (string.Equals(ViewBag.UserName, "OPCHCM001", StringComparison.OrdinalIgnoreCase))
                        {


                            <a href="/DanhMuc/ViewDanhMucKH_FillCN" onclick="runReport()"> Khách hàng</a>
                        }
                        else
                        {
                            <a href="/DanhMuc/ViewDanhMucKHCN" onclick="runReport()"> Khách hàng</a>
                        }

                    </li>

                </ul>
            </li>
            <li>
                <div class="iocn-link">
                    <a href="/Home/MauIn">
                        <i class='bx bxs-printer'></i>
                        <span class="link_name">Mẫu In</span>
                    </a>

                </div>
                <ul class="sub-menu">
                    <li><a class="link_name" href="/Home/MauIn">Mẫu In</a></li>
                    <li class="liTitle"><a href="/MauInChungTu/MauInNLCB_Fill">1.Chứng Từ Phiếu Nhập</a></li>
                    <li class="liTitle"><a href="/MauInChungTu/PhieuNhapXNTT_Fill">2.Phiếu Xác Nhận Thanh Toán</a></li>
                    <li class="liTitle"><a href="/MauInChungTu/PhieuXuatKho_Fill">3.Phiếu Xuất Kho</a></li>
                    @*<li><a href="#">Login Form</a></li>
                        <li><a href="#">Card Design</a></li>*@
                </ul>
            </li>

            <li class="report-li">
                <div class="iocn-link">
                    <a href="/Home/MainBaoCao" onclick="showLoader()">
                        <i class='bx bx-plug'></i>
                        <span class="link_name">Báo cáo</span>
                    </a>
                    @*<i class='bx bxs-chevron-down arrow'></i>*@
                </div>
                <ul class="sub-menu">
                    <li><a class="link_name" href="/Home/MainBaoCao">Báo Cáo</a></li>
                    <li>
                        <a href="#">1.Báo Cáo Quản Trị</a>
                        <ul>
                            @if (string.Equals(ViewBag.UserName, "admin", StringComparison.OrdinalIgnoreCase))
                            {


                                <li class="liTitle"><a href="/DoanhThuChiNhanh/DoanhThuChiNhanhKGam_Fill">1.1.Doanh Thu Chi Nhánh</a></li>
                            }
                            else
                            {
                                <li class="liTitle"><a href="/DoanhThuChiNhanh/DoanhThuChiNhanhKGam_CN_Fill">1.1.Doanh Thu Chi Nhánh</a></li>
                            }
                            @if (string.Equals(ViewBag.UserName, "admin", StringComparison.OrdinalIgnoreCase))
                            {


                                <li class="liTitle"><a href="/DoanhThuChiNhanh/DoanhThuChiNhanh_Admin_Fill">1.2.Doanh Thu Chi Nhánh Theo Gam</a></li>
                            }
                            else
                            {
                                <li class="liTitle"><a href="/DoanhThuChiNhanh/DoanhThuChiNhanh_Fill">1.2.Doanh Thu Chi Nhánh Theo Gam</a></li>
                            }

                            <li class="liTitle"><a href="/DoanhThuChiNhanh/DoanhThuChiNhanhTinhLuong_Fill">1.3.Doanh Thu Chi Nhánh Tính Lương</a></li>

                        </ul>
                    </li>

                    <li>
                        <a href="#">2.Báo Cáo Nghiệp Vụ</a>
                        <ul>
                            <li class="liTitle"><a href="/bangkehoadon/bangkehoadon_Fill">2.1.Bảng Kê Chứng Từ SO</a></li>
                            <li class="liTitle"><a href="/BaoCaobanHangCN/BaoCaoBanHangCN_Fill">2.2.Báo Cáo Bán Hàng CN</a></li>
                            <li class="liTitle"><a href="/BaoCaoBanHangTDV/BaoCaoBanHangTDV_Fill">2.3.Báo Cáo Bán Hàng TDV</a></li>
                            <li class="liTitle"><a href="/BaoCaoTienVeCN/BaoCaoTienVeCN_Fill">2.4.Báo Cáo Tiền Về CN</a></li>
                            <li class="liTitle"><a href="/BaoCaoTienVeCN/BaoCaoTienVeTDV_Fill">2.5.Báo Cáo Tiền Về TDV</a></li>
                            <li class="liTitle"><a href="/BaoCaoDoanhThuGamHangTheoDoiTuong/BaoCaoDoanhThuGamHangTheoDoiTuong_Fill">2.6.Doanh Thu Gam Theo Đối Tượng</a></li>
                        </ul>
                    </li>


                    <!-- Thêm các mục con khác của submenu "Báo cáo nghiệp vụ" nếu cần -->
                </ul>
            </li>



            <li>
                <a href="/Home/DoiMatKhau">
                    <i class='bx bx-cog'></i>
                    <span class="link_name">Đổi mật khẩu</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name" href="/home/DoiMatKhau">Đổi mật khẩu</a></li>
                </ul>
            </li>




            <li onclick="logout()">
                <a>
                    <i class='bx bx-log-out'></i>
                    <span class="link_name">Đăng xuất</span>
                </a>
                <ul class="sub-menu blank">
                    <li><a class="link_name">Đăng xuất</a></li>
                </ul>
            </li>
        </ul>
    </div>
    <section class="home-section">
        <nav>
            <div class="home-content">
                <i class='bx bx-menu'></i>
                <span class="text">Trang chủ</span>
            </div>
            <div class="search-box">
                <input type="text" placeholder="Search...">
                <i class='bx bx-search'></i>
            </div>
        </nav>
        <div class="home-content1">
            <div class="overview-boxes">
                <div class="box" style="overflow:auto;width:400px;height:200px">
                    <table id="product" style="width:500px;height:200px; border-collapse: collapse;overflow:scroll">

                        <tr class="title">
                            <th colspan="4" class="top10" style="font-size:18px;padding:5px">Top 10 sản phẩm bán chạy</th>
                        </tr>
                        <tr class="title" style="background-color:black;color:white;width:30px;padding:5px">
                            <td style="padding-right:10px">STT</td>
                            <td>Mã Vật Tư</td>
                            <td>Tên Vật Tư</td>
                            <td>Doanh Thu</td>
                        </tr>
                        <tbody>
                            @if (Model != null && Model.Tables.Count > 0 && Model.Tables[0].Rows.Count > 0)
                            {
                                int stt = 1;
                                foreach (DataRow row4 in Model.Tables[0].Rows)
                                {
                                    <tr>
                                        <td style="padding:10px">@stt</td>
                                        <td>@row4["Ma_Vt"]</td>
                                        <td>@row4["Ten_Vt"]</td>
                                        <td>@String.Format("{0:n0}", Convert.ToDecimal(row4["Doanh_Thu"]))</td>
                                    </tr>
                                    stt++;
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="4">No data available.</td>
                                </tr>
                            }
                        </tbody>

                    </table>
                </div>
                @*<div class="box" style="overflow:auto;width:400px;height:200px">
                        <table id="product" style="width:500px;height:200px; border-collapse: collapse;overflow:scroll">

                            <tr class="title">
                                <th colspan="4" class="top10">Top 10 sản phẩm bán chạy</th>
                            </tr>
                            <tr class="title" style="background-color:black;color:white">
                                <td style="padding-right:10px">STT</td>
                                <td>Mã Vật Tư</td>
                                <td>Tên Vật Tư</td>
                                <td>Doanh Thu</td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td>100001</td>
                                <td>Product 1</td>
                                <td>120000</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>100002</td>
                                <td>Product 2</td>
                                <td>150000</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>100003</td>
                                <td>Product 3</td>
                                <td>180000</td>
                            </tr>

                        </table>
                    </div>*@
                @*<div class="box" style="overflow:auto;width:400px;height:200px">
                                <table id="product" style="width:500px;height:200px; border-collapse: collapse;overflow:scroll">

                                    <tr class="title">
                                        <th colspan="4" class="top10">Top 10 sản phẩm bán chạy</th>
                                    </tr>
                                    <tr class="title" style="background-color:black;color:white">
                                        <td style="padding-right:10px">STT</td>
                                        <td>Mã Vật Tư</td>
                                        <td>Tên Vật Tư</td>
                                        <td>Doanh Thu</td>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>100001</td>
                                        <td>Product 1</td>
                                        <td>120000</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>100002</td>
                                        <td>Product 2</td>
                                        <td>150000</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>100003</td>
                                        <td>Product 3</td>
                                        <td>180000</td>
                                    </tr>

                                </table>
                            </div>
                    </div>*@
            </div>
        </div>
    </section>
    <div class="tab-control">
        <ul class="tabs" style="background-color: #1d1b31; bottom: 0; left: 0; right: 0;">
            <li class="tab selected" style="padding-right:10px"><a href="#">Home</a></li>
            <li class="tab selected"><a href="#">Some Thing 2</a><a class="closeTab" href="">✕</a></li>
            <li class="tab selected"><a href="#">Some Thing 3</a><a class="closeTab" href="">✕</a></li>
                <li class="tab selected"><a href="#">Some Thing 4</a><a class="closeTab" href="">✕</a></li>
                <li class="tab selected"><a href="#">Some Thing 2</a><a class="closeTab" href="">✕</a></li>
                <li class="tab selected"><a href="#">Some Thing 3</a><a class="closeTab" href="">✕</a></li>
                <li class="tab selected"><a href="#">Some Thing 4</a><a class="closeTab" href="">✕</a></li>
        </ul>
    </div>
    <script>
        function logout() {
            window.location.href = "/home/login"
        }
        document.getElementById("TOP1").innerHTML = Response.innerHTML.g;

        $("#leftside-navigation .sub-menu > a").click(function (e) {
            $("#leftside-navigation ul ul").slideUp(), $(this).next().is(":visible") || $(this).next().slideDown(),
                e.stopPropagation()
        })
        function ChangPassword() {
            window.location.href = "/home/DoiMatKhau"
        }
    </script>

    <script>
        //icon chuc nang sidebar
        let reportLi = document.querySelector(".report-li");
        reportLi.addEventListener("click", (e) => {
            console.log("Clicked on report-li");
            let subMenu = e.currentTarget.querySelector(".sub-menu");
            subMenu.classList.toggle("showSubMenu");
        });

        let arrow = document.querySelectorAll(".arrow");
        for (var i = 0; i < arrow.length; i++) {
            arrow[i].addEventListener("click", (e) => {
                let arrowParent = e.target.parentElement.parentElement; // selecting main parent of arrow
                arrowParent.classList.toggle("showMenu");
            });
        }

        let sidebar = document.querySelector(".sidebar");
        // Sửa lớp CSS từ "close" thành "showSidebar"
        sidebar.classList.remove("close");
        sidebar.classList.add("showSidebar");
        let sidebarBtn = document.querySelector(".bx-menu");
        console.log(sidebarBtn);
        sidebarBtn.addEventListener("click", () => {
            sidebar.classList.toggle("close");
        });
    </script>

    <script>

        //function showLoader() {
        //    const loader = document.querySelector(".loader");
        //    loader.classList.remove("loader-hidden");
        //}

        //// Function to hide the loader
        //function hideLoader() {
        //    const loader = document.querySelector(".loader");
        //    loader.classList.add("loader-hidden");
        //}



        window.addEventListener("load", () => {
            // Hide the loader after the page is loaded
            hideLoader();
        });
    </script>
    @*<script>
            function runReport() {
                // Hiển thị thẻ span có id là "spanText"
                showLoader();
                const spanElement = document.getElementById("spanText");
                spanElement.style.display = "block";
            }
        </script>*@
    <script>
        window.onload = function () {
            var username = localStorage.getItem("username");
            if (username) {
                var nameInput = document.getElementById("Name");
                if (nameInput) {
                    nameInput.value = username;
                }
                localStorage.removeItem("username");
            }

        };
    </script>
    <script>
        function showLoader() {
            const loader = document.querySelector(".loader");
            loader.classList.remove("loader-hidden");
        }
        function hideLoader() {
            const loader = document.querySelector(".loader");
            loader.classList.add("loader-hidden");
            createChart(chartData);
        }
        window.addEventListener("load", () => {
            hideLoader();
            applyCheckboxAndColumnState();
        });
    </script>
    @*<script>
            document.addEventListener("DOMContentLoaded", function () {
                // Lấy danh sách tất cả các thẻ <a> có class "closeTab"
                const closeTabLinks = document.querySelectorAll(".closeTab");

                // Lặp qua từng thẻ <a> và thêm sự kiện click vào chúng
                closeTabLinks.forEach(function (link) {
                    link.addEventListener("click", function (event) {
                        event.preventDefault(); // Ngăn chặn hành vi mặc định của thẻ <a>

                        // Ẩn phần tử <li> chứa thẻ <a> đã được click
                        const liElement = link.closest("li");
                        if (liElement) {
                            liElement.style.display = "none";
                        }
                    });
                });
            });
        </script>*@
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const subMenuLinks = document.querySelectorAll(".liTitle a");

            subMenuLinks.forEach(function (subMenuLink) {
                subMenuLink.addEventListener("click", function (event) {
                    event.preventDefault();

                    const tabTitle = subMenuLink.textContent;
                    const subMenuLinkHref = subMenuLink.getAttribute("href");

                    // Lấy danh sách các tab hiện có trong localStorage
                    const existingTabs = JSON.parse(localStorage.getItem("savedTabs")) || [];

                    // Thêm tab mới vào danh sách
                    existingTabs.push(tabTitle);
                    localStorage.setItem("savedTabs", JSON.stringify(existingTabs));

                    // Chuyển view tới thẻ li tương ứng
                    if (subMenuLinkHref) {
                        // Lưu trạng thái hiện tại vào localStorage trước khi chuyển trang
                        localStorage.setItem("currentTab", tabTitle);
                        window.location.href = subMenuLinkHref;
                    }
                });
            });

            // Cập nhật tab hiện tại trong view 2
            const tabControlTabs = document.querySelector(".tab-control .tabs");
            const currentTabTitle = localStorage.getItem("currentTab");
            if (currentTabTitle) {
                const currentTab = document.createElement("li");
                currentTab.classList.add("tab", "selected");
                currentTab.innerHTML = `
                    <a href="#">${currentTabTitle}</a>
                    <a class="closeTab" href="">✕</a>
                `;
                tabControlTabs.appendChild(currentTab);
            }

            // Xóa thông tin tab hiện tại sau khi đã sử dụng
            localStorage.removeItem("currentTab");
        });
    </script>

</body>
</html>